\chapter{Results} % Chapter title

\label{chapter:results} % For referencing the chapter elsewhere, use \ref{chapter:computational_neuro} 

%----------------------------------------------------------------------------------------

\section{Multiple Query Optimization}

The non-ML circuit as well as the ML optimized one are run on the simulator as well as on real hardware. For this, the IBM Falcon r4L processor \code{ibmq\_bogota v1.6.37} is used. Each circuit runs 13 times, and the parity function referenced in chapter \toco{add reference to parity explanation} is used for the ML optimized circuit as well as the non-ML circuit to allow for a direct comparison. In addition, the ML optimized circuit is also assessed through the custom evaluation function from the non-ML circuit, which filters the results to retrieve only the relevant labels. Initial runs are made on a problem space $\left\mathcal{D}_{2\times2}|\right| =\ 300$, out of which 25\%, so 75 records, are taken and evaluated. These 75 records are the same used in the evaluation of the ML optimized circuit in chapter \ref{chapter:mqo_machine_learning}. Later runs, limited only to the filtered evaluation, are run on a problem space $\left|\mathcal{D}_{2\times2}\right| =\ 1000$ of newly generated records\footnote{As these records are randomly generated, it cannot be assured that there might not be duplicate entries that were already inside the training/evaluation set of the ML optimized circuit. As this case can also appear in real life, no further filtering is done to the generation of records}.


\begin{figure}
    \centering
    \scalebox{0.9}{
        \includesvg{thesis/Appendices/comparison_ml_noml_circuit_filtered_acc.svg}
    }
    \caption{Caption}
    \label{figure:comparison_ml_noml_filtered_acc}
\end{figure}

\begin{figure}
    \centering
    \scalebox{0.9}{
        \includesvg{thesis/Appendices/comparison_ml_noml_circuit_parity_acc.svg}
    }
    \caption{Caption}
    \label{figure:comparison_ml_noml_parity_acc}
\end{figure}

\begin{figure}
    \centering
    \scalebox{0.8}{
        \includesvg{thesis/Appendices/comparison_noml_sim_rhw_distanec.svg}
    }
    \caption{Caption}
    \label{figure:boxplot_noml_distance}
\end{figure}

\begin{figure}
    \centering
    \scalebox{0.8}{
        \includesvg{thesis/Appendices/comparison_ml_sim_rhw_distanec.svg}
    }
    \caption{Caption}
    \label{figure:boxplot_ml_distance}
\end{figure}

\newpage

\section{Quantum Neural Network}

\subsection{Evaluation On Simulator}

\begin{table}[!h]
	\centering
	        
	\begin{tabular}{p{0.12\textwidth}p{0.15\textwidth}|p{0.13\textwidth}p{0.13\textwidth}p{0.13\textwidth}p{0.13\textwidth}}
		\hline 
		\textbf{Dataset}        & \textbf{VQC} & \textbf{COBYLA} & \textbf{SPSA}  & \textbf{AMSGR.} & \textbf{BFGS} \\
		\hline 
		\multirow{6}{*}{\textbf{Adhoc}}  & q\_circuit\_01 & 0.600  & 0.665 & 0.660   & 0.720 \\
		                        & q\_circuit\_02 & 0.700  & 0.795 & 0.650   & \underline{0.800} \\
		                        & q\_circuit\_03 & 0.700  & 0.705 & 0.660   & 0.650 \\
		                        & q\_circuit\_04 & 0.705 & 0.650 & 0.645   & 0.650 \\
		                        & q\_circuit\_05 & 0.565 & 0.690 & 0.65   & 0.715 \\
		\cline{2-6} 
		                        & \textbf{Average} & 0.654  & 0.701 & 0.653  & \textbf{0.707} \\
		\hline 
		\multirow{6}{*}{\textbf{Custom}} & q\_circuit\_01 & 0.515  & 0.550 & 0.700   & 0.630 \\
		                        & q\_circuit\_02 & 0.690  & 0.550 & 0.500   & 0.605 \\
		                        & q\_circuit\_03 & 0.700  & 0.645 & 0.500   & 0.700 \\
		                        & q\_circuit\_04 & 0.590  & 0.535 & 0.550  & 0.520 \\
		                        & q\_circuit\_05 & 0.505  & 0.65 & 0.615   & \underline{0.740} \\
		\cline{2-6} 
		                        & \textbf{Average}      & 0.600 & 0.586 & 0.573   & \textbf{0.639} \\
		\hline 
		\multirow{6}{*}{\textbf{Iris}}   & q\_circuit\_01 & 1.00  & 1.00 & 1.00   & 1.00 \\
		                        & q\_circuit\_02 & 1.00  & 1.00 & 1.00   & 1.00 \\
		                        & q\_circuit\_03 & 1.00  & 1.00 & 1.00   & 1.00 \\
		                        & q\_circuit\_04 & 1.00  & 0.885 & 0.950   & 1.00 \\
		                        & q\_circuit\_05 & 1.00  & 1.00 & 1.00   & 1.00 \\
		\cline{2-6} 
		                        & \textbf{Average}      & \textbf{1.00}  & 0.977 & 0.990   & \textbf{1.00} \\
		\hline 
		\multirow{6}{*}{\textbf{Rain}}   & q\_circuit\_01 & 0.745  & 0.665 & 0.650   & 0.730 \\
		                        & q\_circuit\_02 & 0.625  & 0.665 & 0.785   & 0.695 \\
		                        & q\_circuit\_03 & 0.580 & 0.800 & 0.800  & 0.720 \\
		                        & q\_circuit\_04 & 0.395  & 0.545 & \underline{0.825}   & 0.570 \\
		                        & q\_circuit\_05 & 0.620 & 0.620 & 0.615   & 0.685 \\
		\cline{2-6} 
		                        & \textbf{Average}      & 0.593  & 0.659 & \textbf{0.735}   & 0.680 \\
		\hline 
		\multirow{6}{*}{\textbf{Vlds}}   & q\_circuit\_01 & 0.845  & 0.820 & 0.800   & 0.800 \\
		                        & q\_circuit\_02 & 0.770  & 0.730 & 0.780   & 0.650 \\
		                        & q\_circuit\_03 & 0.795  & 0.760 & 0.750   & 0.790 \\
		                        & q\_circuit\_04 & 0.805  & 0.525 & 0.750   & \underline{0.925} \\
		                        & q\_circuit\_05 & 0.795  & 0.600 & 0.900   & 0.690 \\
		\cline{2-6} 
		                        & \textbf{Average}      & \textbf{0.802}  & 0.687 & 0.796   & 0.771 \\
		\hline
	\end{tabular}
	\caption{Comparison of accuracy for the optimizers COBYLA, SPSA, AMSGRAD (Adam) and BFGS over and average of 10 runs using two VQC layers for the quantum simulator training runs and binary datasets.}
	\label{table:accuracy_comparison_binary_dataset_and_optimizers_training_runs}
\end{table}


\subsection{Evaluation On Real Hardware}

\begin{table}[!h]
	\centering
	        
	\begin{tabular}{p{0.12\textwidth}p{0.15\textwidth}|p{0.13\textwidth}p{0.13\textwidth}p{0.13\textwidth}p{0.13\textwidth}}
		\hline 
		\textbf{Dataset}        & \textbf{VQC} & \textbf{COBYLA} & \textbf{SPSA}  & \textbf{AMSGR.} & \textbf{BFGS} \\
		\hline 
		\multirow{6}{*}{\textbf{Adhoc}}  & q\_circuit\_01  & 0.610  & 0.645 & 0.650    & 0.715 \\
		                        & q\_circuit\_02 & \underline{0.745}  & \underline{0.745} & 0.665    & 0.715 \\
		                        & q\_circuit\_03 & 0.675  & 0.695 & 0.665    & 0.715 \\
		                        & q\_circuit\_04 & 0.650  & 0.650 & 0.655    & 0.65 \\
		                        & q\_circuit\_05 & 0.605  & 0.680 & 0.635    & 0.715 \\
		\cline{2-6} 
		                        & \textbf{Average} & 0.657  & 0.683 & 0.654    & \textbf{0.702} \\
		\hline 
		\multirow{6}{*}{\textbf{Custom}} & q\_circuit\_01  & 0.555  & 0.600 & 0.660    & 0.625 \\
		                        & q\_circuit\_02  & 0.655  & 0.575 & 0.500    & 0.620 \\
		                        & q\_circuit\_03  & 0.7  & 0.610 & 0.500    & 0.640 \\
		                        & q\_circuit\_04  & 0.57  & 0.515 & 0.550    & 0.500 \\
		                        & q\_circuit\_05  & 0.45  & 0.625 & 0.620    & \underline{0.750} \\
		\cline{2-6} 
		                        & \textbf{Average} & 0.586  & 0.585 & 0.566    & \textbf{0.627} \\
		\hline 
		\multirow{6}{*}{\textbf{Iris}}   & q\_circuit\_01 & 1.00  & 1.00 & 1.00    & 1.00 \\
		                        & q\_circuit\_02 & 1.00  & 0.865 & 1.00    & 1.00 \\
		                        & q\_circuit\_03 & 1.00  & 1.00 & 1.00    & 1.00 \\
		                        & q\_circuit\_04 & 1.00  & 0.885 & 0.955    & 0.805 \\
		                        & q\_circuit\_05 & 0.880  & 0.985 & 1.00    & 1.00 \\
		\cline{2-6} 
		                        & \textbf{Average} & 0.976  & 0.947 & \textbf{0.991}    & 0.961 \\
		\hline 
		\multirow{6}{*}{\textbf{Rain}}   & q\_circuit\_01 & 0.495  & 0.600 & 0.71 0  & 0.665 \\
		                        & q\_circuit\_02 & 0.710  & 0.635 & 0.715    & 0.665 \\
		                        & q\_circuit\_03 & 0.595  & \underline{0.790} & 0.745    & 0.550 \\
		                        & q\_circuit\_04 & 0.440  & 0.495 & 0.775    & 0.555 \\
		                        & q\_circuit\_05 & 0.650  & 0.470 & 0.640   & 0.620 \\
		\cline{2-6} 
		                        & \textbf{Average} & 0.578  & 0.598 & \textbf{0.717}    & 0.611 \\
		\hline 
		\multirow{6}{*}{\textbf{Vlds}}   & q\_circuit\_01 & 0.855  & 0.770 & 0.615    & 0.710 \\
		                        & q\_circuit\_02 & 0.705  & 0.885 & 0.740    & 0.635 \\
		                        & q\_circuit\_03 & 0.725  & 0.765 & 0.705    & 0.870 \\
		                        & q\_circuit\_04 & 0.81  & 0.485 & 0.750    & \underline{0.950} \\
		                        & q\_circuit\_05 & 0.755  & 0.615 & 0.745    & 0.735 \\
		\cline{2-6} 
		                        & \textbf{Average} & 0.770  & 0.704 & 0.711    & \textbf{0.780} \\
		\hline
	\end{tabular}
	\caption{Comparison of accuracy for the optimizers COBYLA, SPSA, AMSGRAD (Adam) and BFGS over and average of 10 runs using two VQC layers - bound to the weights of the highest scoring trainings run - for the quantum computer evaluation runs and binary datasets.}
	\label{table:accuracy_comparison_binary_dataset_and_optimizers_evaluation_runs}
\end{table}

\subsection{Comparison}

\begin{table}[!h]
	\centering
	\begin{tabular}{rccc}
		\hline 
		\thead{Dataset} & \thead{QNN (Quantum Simulator)} & \thead{QNN (Quantum Computer)} \\
		\hline 
		Iris    & 1.00     & 1.00  \\
		Rain    & 0.825    & 0.790 \\
		Vlds    & 0.925    & 0.950 \\
		Custom  & 0.74     & 0.750 \\
		Adhoc   & 0.800    & 0.745 \\
		\hline
		\textbf{Average}  & \textbf{0.858} & \textbf{0.847}  \\
		\hline
	\end{tabular}
	\caption{Comparison of QNN ... on a quantum simulator as well as on a real quantum computer. The table shows the accuracy of the best approach for each of the circuits and optimizer types.}
	\label{table:comparison_binary_datasets_accuracy}
\end{table}


\clearpage